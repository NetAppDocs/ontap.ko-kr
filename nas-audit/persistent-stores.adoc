---
permalink: nas-audit/persistent-stores.html 
sidebar: sidebar 
keywords: overview, persistent store, fpolicy 
summary: ONTAP 9.14.1부터 FPolicy를 사용하면 SVM의 비동기적 정책에 대한 파일 액세스 이벤트를 캡처하는 영구 저장소를 설정할 수 있습니다. 영구 저장소는 클라이언트 I/O 처리를 FPolicy 알림 처리와 분리하여 클라이언트 지연 시간을 줄여 줍니다. 동기 및 비동기 필수 구성은 지원되지 않습니다. 
---
= FPolicy 영구 저장소
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP 9.14.1부터 FPolicy를 사용하면 SVM의 비동기적 정책에 대한 파일 액세스 이벤트를 캡처하는 영구 저장소를 설정할 수 있습니다. 영구 저장소는 클라이언트 I/O 처리를 FPolicy 알림 처리와 분리하여 클라이언트 지연 시간을 줄여 줍니다. 동기(필수 또는 비필수) 및 비동기 필수 구성은 지원되지 않습니다.

이 기능은 FPolicy 외부 모드에서만 사용할 수 있습니다. 사용하는 파트너 응용 프로그램이 이 기능을 지원해야 합니다. 파트너와 협력하여 이 FPolicy 구성이 지원되도록 해야 합니다.



== 모범 사례

클러스터 관리자는 FPolicy가 활성화된 각 SVM에서 영구 저장소의 볼륨을 구성해야 합니다. 구성된 영구 저장소는 일치하는 모든 FPolicy 이벤트를 캡처하며, FPolicy 파이프라인에서 추가로 처리되어 외부 서버로 전송됩니다.

영구 저장소는 예상치 못한 재부팅이 발생하거나 FPolicy가 비활성화되었다가 다시 활성화되었을 때 마지막 이벤트가 수신된 때처럼 유지됩니다. 테이크오버 작업 후 새 이벤트는 파트너 노드에서 저장하고 처리합니다. 반환 작업 후 영구 저장소는 노드 테이크오버 발생 시 계속 처리될 수 있는 처리되지 않은 이벤트의 처리를 다시 시작합니다. 라이브 이벤트는 처리되지 않은 이벤트보다 우선 순위가 부여됩니다.

영구 저장소 볼륨이 한 노드에서 동일한 SVM의 다른 노드로 이동하는 경우 아직 처리되지 않은 알림도 새 노드로 이동됩니다. 를 다시 실행해야 합니다 `fpolicy persistent-store create` 보류 중인 알림이 외부 서버로 전달되도록 볼륨을 이동한 후 두 노드 중 하나에서 명령을 실행합니다.

영구 저장소 볼륨은 SVM별로 설정됩니다. 각 FPolicy가 활성화된 SVM에 대해 영구 저장소 볼륨을 생성해야 합니다.

Fpolicy에서 최대 트래픽을 모니터링할 것으로 예상되는 LIF로 노드에 영구 저장소 볼륨을 생성합니다.

영구 저장소에 누적된 알림이 프로비저닝된 볼륨 크기를 초과하면 FPolicy가 적절한 EMS 메시지와 함께 수신 알림을 삭제하기 시작합니다.

영구 저장소 볼륨 이름과 볼륨 생성 시 지정된 접합 경로가 일치해야 합니다.

스냅샷 정책을 로 설정합니다 `none` 에 대해 이야기해 보려고 합니다 `default`. 이는 스냅샷을 실수로 복구하여 현재 이벤트가 손실되지 않도록 하고 중복 이벤트 처리를 방지하기 위한 것입니다.

영구 저장소 볼륨을 외부 사용자 프로토콜 액세스(CIFS/NFS)에 액세스할 수 없도록 하여 영구 이벤트 레코드가 실수로 손상되거나 삭제되지 않도록 합니다. 이를 위해 FPolicy를 활성화한 후 ONTAP에서 볼륨을 마운트 해제하여 접합 경로를 제거하면 사용자 프로토콜 액세스에 액세스할 수 없게 됩니다.

자세한 내용은 을 참조하십시오 link:https://docs.netapp.com/us-en/ontap/nas-audit/create-persistent-stores.html["영구 저장소를 만듭니다"].
