---
sidebar: sidebar 
permalink: snapmirror-active-sync/architecture-concept.html 
keywords: SM-BC, SMBC, snapmirror active sync 
summary: 애플리케이션 보호를 올바르게 구성하기 위한 SnapMirror 활성 동기화의 아키텍처를 이해해야 합니다. 
---
= SnapMirror 액티브 동기화 아키텍처
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
SnapMirror Active Sync 아키텍처는 두 클러스터 모두에서 활성 워크로드를 지원하여 두 클러스터 모두에서 운영 워크로드를 동시에 처리할 수 있습니다. 일부 국가의 금융 기관을 위한 규정에 따라 기업은 SnapMirror 액티브 동기화가 지원되는 "Tick-Tock" 구축에서도 보조 데이터 센터에서 주기적으로 서비스를 받을 수 있어야 합니다.

비즈니스 연속성을 위해 보호하기 위한 데이터 보호 관계는 SVM(스토리지 가상 시스템) 내의 서로 다른 볼륨의 애플리케이션별 LUN을 일관성 그룹에 추가하여 소스 스토리지 시스템과 타겟 스토리지 시스템 간에 생성됩니다. 정상적인 작업에서 엔터프라이즈 애플리케이션은 기본 정합성 보장 그룹에 쓰며, 이 I/O는 미러 정합성 보장 그룹에 동기식으로 복제됩니다.

image:snapmirror-active-sync-architecture.png["SnapMirror Active 아키텍처"]

데이터 보호 관계에 두 개의 개별 데이터 복사본이 존재하지만 SnapMirror 활성 동기화는 동일한 LUN ID를 유지하므로 애플리케이션 호스트는 이를 한 번에 하나의 LUN 복사본만 쓰지만 여러 경로가 있는 공유 가상 장치로 인식합니다. 장애로 인해 운영 스토리지 시스템이 오프라인이 되면 ONTAP는 이 장애를 감지하고 중재자를 사용하여 재확인합니다. ONTAP와 중재자 모두 운영 사이트에 대해 ping을 수행할 수 없는 경우 ONTAP는 자동 페일오버 작업을 수행합니다. 이 프로세스를 통해 이전에 장애 조치를 위해 필요했던 수동 개입 또는 스크립팅이 필요 없이 특정 애플리케이션만 장애 조치됩니다.

기타 고려 사항:

* 비즈니스 연속성을 위한 보호 범위를 벗어나는 미러링되지 않은 볼륨이 지원됩니다.
* 비즈니스 연속성을 위해 보호되는 볼륨에 대해 하나의 다른 SnapMirror 비동기식 관계만 지원됩니다.
* Cascade 토폴로지는 무중단 업무 운영을 위한 보호 기능이 지원되지 않습니다.




== ONTAP 중재자

ONTAP 중재자는 두 개의 ONTAP 클러스터와 다른 세 번째 장애 도메인에 설치됩니다. 주요 역할은 SnapMirror 액티브 동기화 복사본에 대한 패시브 감시 역할을 하는 것입니다. 네트워크 파티션이나 하나의 복사본을 사용할 수 없는 경우 SnapMirror 액티브 동기화는 중재자를 사용하여 다른 복사본의 I/O를 중단하면서 I/O를 계속 제공할 복사본을 결정합니다. 이 설정에는 세 가지 주요 구성 요소가 있습니다.

* SnapMirror 활성 동기화 운영 CG를 호스팅하는 운영 ONTAP 클러스터입니다
* 미러 CG를 호스팅하는 보조 ONTAP 클러스터입니다
* ONTAP 중재자


ONTAP 중재자는 패시브 쿼럼 증인으로서 SnapMirror 액티브 동기화 구성에서 중요한 역할을 수행하여 장애 시 쿼럼 유지보수를 보장하고 데이터 액세스를 향상하도록 합니다. 피어 컨트롤러의 생동감을 결정하는 컨트롤러에 대한 ping 프록시 역할을 합니다. 중재자가 전환 작업을 능동적으로 트리거하지는 않지만, 네트워크 통신 문제 발생 시 정상 노드가 파트너 상태를 확인할 수 있도록 하는 중요한 기능을 제공합니다. ONTAP 중재자는 쿼럼 증인으로서 피어 클러스터에 대한 대체 경로(효과적으로 프록시 역할을 함)를 제공합니다.

또한 클러스터가 쿼럼 프로세스의 일부로 이 정보를 가져올 수 있습니다. 이 솔루션은 통신을 위해 노드 관리 LIF와 클러스터 관리 LIF를 활용합니다. 여러 경로를 통해 중복 연결을 설정하여 사이트 장애와 ISL(Interswitch Link) 장애를 구분합니다. 이벤트로 인해 클러스터가 ONTAP 중재자 소프트웨어 및 모든 해당 노드와의 연결이 끊어지면 연결할 수 없는 것으로 간주됩니다. 이렇게 하면 알림이 트리거되고 보조 사이트의 미러 CG(정합성 보장 그룹)로 자동 페일오버가 설정되므로 클라이언트에 대한 입출력이 중단되지 않습니다. 복제 데이터 경로는 하트비트 메커니즘에 의존하며, 네트워크 장애나 이벤트가 특정 기간 이상 지속되는 경우 하트비트 장애가 발생하여 관계가 동기화되지 않을 수 있습니다. 하지만 LIF가 다른 포트로 페일오버하는 것과 같은 중복 경로가 존재하면 하트비트를 유지하고 이러한 중단을 방지할 수 있습니다.

요약하자면, ONTAP 중재자는 다음과 같은 목적으로 사용됩니다.

* 정족수를 설정한다
* 자동 페일오버(AUFO)를 통한 지속적인 가용성
* 계획된 페일오버(PFO)



NOTE: ONTAP mediator 1.7은 비즈니스 연속성을 위해 10개의 클러스터 쌍을 관리할 수 있습니다.


NOTE: ONTAP 중재자를 사용할 수 없는 경우 계획된 또는 자동화된 페일오버를 수행할 수 없습니다. 애플리케이션 데이터는 데이터 손실을 방지하기 위해 중단 없이 계속해서 동기식으로 복제됩니다.



== 운영

다음 그림에서는 개괄적인 SnapMirror 액티브 동기화의 설계를 보여 줍니다.

image:workflow_san_snapmirror_business_continuity.png["높은 수준의 SnapMirror 활성 동기화 설계"]

이 다이어그램은 운영 데이터 센터의 SVM(스토리지 VM)에서 호스팅되는 엔터프라이즈 애플리케이션을 보여 줍니다. SVM은 볼륨 5개를 포함하며, 볼륨 3개는 일관성 그룹의 일부입니다. 일관성 그룹의 볼륨 3개가 보조 데이터 센터에 미러링됩니다. 정상적인 상황에서는 모든 쓰기 작업이 운영 데이터 센터에 수행됩니다. 실제로 이 데이터 센터는 I/O 작업의 소스로 사용되고, 보조 데이터 센터는 대상으로 작동합니다.

운영 데이터 센터에서 재해 발생 시 ONTAP는 2차 데이터 센터가 모든 I/O 작업을 1차 데이터 센터로 수행하도록 지시합니다. 정합성 보장 그룹에서 미러링되는 볼륨만 제공됩니다. SVM의 다른 두 볼륨과 관련된 모든 작업은 재해 이벤트의 영향을 받습니다.



== 대칭적인 액티브/액티브

SnapMirror Active Sync는 비대칭 솔루션 및 대칭 솔루션을 제공합니다.

in_Asymmetric configuration_에서 기본 스토리지 복사본은 활성 최적화 경로를 노출하고 클라이언트 입출력을 능동적으로 제공합니다 2차 사이트는 I/O에 원격 경로를 사용합니다 보조 사이트의 스토리지 경로는 최적화되지 않은 액티브 사이트로 간주됩니다. 쓰기 LUN에 대한 액세스는 보조 사이트에서 프록시됩니다.

in_대칭 액티브/액티브 구성 _ 에서는 액티브 최적화 경로가 두 사이트에 모두 표시되고 호스트마다 다르며 구성이 가능합니다. 즉, 양쪽의 호스트가 액티브 입출력을 위해 로컬 스토리지에 액세스할 수 있습니다

image:snapmirror-active-sync-symmetric.png["대칭 액티브 구성"]

대칭 액티브/액티브는 VMware Metro Storage Cluster, Oracle RAC, SQL을 사용한 Windows 페일오버 클러스터링을 비롯한 클러스터 애플리케이션을 대상으로 합니다.
